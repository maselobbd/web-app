<main class="declined-container">
  <section
    class="universityName-container"
    *ngIf="declinedApplications.length > 0"
  >
    <h1 class="failed-header">Failed applications and bursaries</h1>
    <section *ngFor="let applications of declinedApplications">
      <mat-expansion-panel>
        <mat-expansion-panel-header *ngIf="applications.details">
          <h2>{{ applications.universityName }}</h2>
        </mat-expansion-panel-header>

        <mat-divider class="divider"></mat-divider>

        <section class="table-container">
          <section>
            <table
              mat-table
              [dataSource]="applications.details"
              class="custom-table"
            >
              <ng-container matColumnDef="Bursar full name">
                <th mat-header-cell *matHeaderCellDef class="bold-header col-name">
                  Bursar full name
                </th>
                <td
                  mat-cell
                  *matCellDef="let element"
                  data-label="Student Name"
                >
                  {{ element.fullName }}
                </td>
              </ng-container>

              <ng-container matColumnDef="Bursary amount">
                <th mat-header-cell *matHeaderCellDef class="bold-header">
                  Bursary amount
                </th>
                <td
                  mat-cell
                  *matCellDef="let element"
                  data-label="Bursary amount"
                >
                  {{ element.amount | customCurrency }}
                </td>
              </ng-container>

              <ng-container matColumnDef="Type">
                <th mat-header-cell *matHeaderCellDef class="bold-header">
                  Type
                </th>
                <td mat-cell *matCellDef="let element" data-label="Type">
                  {{ element.reason ? "Declined" : "Revoked" }}
                </td>
              </ng-container>
              <ng-container matColumnDef="Reason given">
                <th mat-header-cell *matHeaderCellDef class="bold-header">
                  Reason given
                </th>
                <td
                  mat-cell
                  *matCellDef="let element"
                  data-label="Reason given"
                  class="reason"
                >
                  {{ element.reason !== 'Other'? element.reason:element.motivation}}
                </td>
              </ng-container>
              <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef class="bold-header"></th>
                <td
                  mat-cell
                  *matCellDef="let element"
                  data-label="Action"
                  class="action-button"
                >
                  <button
                    mat-flat-button
                    color="primary"
                    (click)="navigateToDetailsPage(element.applicationGuid)"
                  >
                    View
                  </button>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </section>
        </section>
      </mat-expansion-panel>
    </section>
  </section>
  <section
    class="error-text-container"
    *ngIf="declinedApplications.length === 0 && !isLoading"
  >
    <app-error-message
      [errorMessage]="noApplicationErrorMessage"
    ></app-error-message>
  </section>
  <app-loader></app-loader>
</main>
